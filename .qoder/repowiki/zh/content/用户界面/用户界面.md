
# 用户界面

<cite>
**本文档引用的文件**
- [app.py](file://web/app.py)
- [analysis_form.py](file://web/components/analysis_form.py)
- [results_display.py](file://web/components/results_display.py)
- [sidebar.py](file://web/components/sidebar.py)
- [header.py](file://web/components/header.py)
- [config_management.py](file://web/pages/config_management.py)
- [cache_management.py](file://web/pages/cache_management.py)
- [token_statistics.py](file://web/pages/token_statistics.py)
- [analysis_runner.py](file://web/utils/analysis_runner.py)
- [progress_tracker.py](file://web/utils/progress_tracker.py)
- [report_exporter.py](file://web/utils/report_exporter.py)
- [main.py](file://cli/main.py)
</cite>

## 目录
1. [简介](#简介)
2. [Web界面](#web界面)
3. [CLI工具](#cli工具)
4. [两种界面的对比与选择](#两种界面的对比与选择)
5. [实际操作示例](#实际操作示例)
6. [结论](#结论)

## 简介

本用户界面文档旨在全面介绍TradingAgents-CN项目提供的两种用户交互方式：基于Streamlit构建的Web界面和基于typer构建的命令行工具（CLI）。文档将详细阐述两种界面的设计原理、核心功能、操作流程，并通过实际操作示例指导用户如何使用。用户可以根据自身需求（如便捷性、自动化、批量处理等）选择最适合的工具。

**本文档引用的文件**
- [app.py](file://web/app.py)

## Web界面

TradingAgents-CN的Web界面是一个基于Streamlit框架构建的现代化、交互式股票分析平台。其设计目标是为用户提供一个直观、易用的图形化操作环境，使用户能够轻松配置分析参数、启动分析任务并查看详细的分析结果。

### 主应用结构 (app.py)

`web/app.py`是整个Web应用的入口点和核心控制器。其结构遵循典型的Streamlit应用模式，主要包含以下几个部分：

1.  **初始化与配置**：导入必要的库，设置页面标题、图标、布局等基础配置，并加载自定义CSS样式以隐藏Streamlit的默认工具栏和部署按钮。
2.  **会话状态管理**：通过`initialize_session_state()`函数初始化`st.session_state`，用于在用户会话期间持久化存储分析结果、运行状态和时间戳等关键信息。
3.  **页面导航**：应用使用侧边栏（`st.sidebar`）提供一个下拉菜单，允许用户在“股票分析”、“配置管理”、“缓存管理”、“Token统计”等不同功能页面之间进行切换。
4.  **功能路由**：主函数`main()`根据用户选择的页面，动态导入并渲染相应的功能模块。例如，当用户选择“配置管理”时，会导入并执行`pages/config_management.py`中的`render_config_management()`函数。
5.  **核心分析流程**：当用户停留在“股票分析”页面时，应用会：
    *   检查API密钥是否配置完整。
    *   渲染侧边栏以获取系统配置（如LLM提供商）。
    *   在主内容区域渲染分析表单。
    *   当用户提交表单后，调用`utils/analysis_runner.py`中的`run_stock_analysis()`函数执行分析。
    *   在分析过程中，通过`progress_tracker`显示实时进度。
    *   分析完成后，将结果存储在会话状态中，并调用`results_display.py`渲染结果。

**本文档引用的文件**
- [app.py](file://web/app.py#L1-L389)

### 核心组件功能

Web界面由多个可复用的组件构成，这些组件位于`web/components/`目录下。

#### 分析表单 (analysis_form.py)

`analysis_form.py`模块负责渲染用户输入分析参数的表单。它包含一个`render_analysis_form()`函数，该函数创建了一个结构化的表单，允许用户配置以下内容：

*   **市场与股票代码**：用户可以选择“美股”或“A股”，并根据所选市场输入相应的股票代码（如AAPL或000001）。
*   **分析日期**：用户可以选择进行分析的基准日期。
*   **研究深度**：通过滑块选择1-5级的研究深度，级别越高，分析越深入，但耗时也越长。
*   **分析师团队**：用户可以通过复选框选择参与分析的AI分析师，包括“市场分析师”、“社交媒体分析师”、“新闻分析师”和“基本面分析师”。
*   **高级选项**：包含“包含情绪分析”、“包含风险评估”和“自定义分析要求”等选项，允许用户进一步定制分析。

表单提交后，会收集