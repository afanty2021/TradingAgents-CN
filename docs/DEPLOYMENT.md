# TradingAgents-CN éƒ¨ç½²æŒ‡å—

## ğŸš€ éƒ¨ç½²æ¦‚è§ˆ

TradingAgents-CN æ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ï¼Œä»æœ¬åœ°å¼€å‘ç¯å¢ƒåˆ°ç”Ÿäº§çº§äº‘éƒ¨ç½²ï¼Œæ»¡è¶³ä¸åŒè§„æ¨¡å’Œéœ€æ±‚ã€‚

## ğŸ—ï¸ éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·ç•Œé¢å±‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Streamlit   â”‚     Vue.js         â”‚    Nginx       â”‚
â”‚  â”‚ (ç®¡ç†ç•Œé¢)    â”‚    (ç”¨æˆ·ç•Œé¢)      â”‚   (åå‘ä»£ç†)    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         API ç½‘å…³å±‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  FastAPI    â”‚     REST APIs      â”‚   Authentication  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         ä¸šåŠ¡é€»è¾‘å±‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Multi-Agent â”‚  Analysis Engine â”‚  Background Tasks â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         æ•°æ®å­˜å‚¨å±‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  MongoDB    â”‚     Redis         â”‚   File System   â”‚
â”‚  â”‚  (ä¸»æ•°æ®åº“)  â”‚   (ç¼“å­˜å±‚)       â”‚   (æœ¬åœ°å­˜å‚¨)   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ³ éƒ¨ç½²ç¯å¢ƒ

### å¼€å‘ç¯å¢ƒ
**é€‚ç”¨åœºæ™¯**: æœ¬åœ°å¼€å‘ã€åŠŸèƒ½æµ‹è¯•ã€å°è§„æ¨¡éƒ¨ç½²

**æŠ€æœ¯æ ˆ**:
- Python 3.10+
- Docker + Docker Compose
- Redis + MongoDB
- Nginx (å¯é€‰)

**å¿«é€Ÿå¯åŠ¨**:
```bash
# 1. ä½¿ç”¨å¼€å‘ç¯å¢ƒé…ç½®
docker-compose -f docker-compose.dev.yml up -d

# 2. éªŒè¯éƒ¨ç½²
curl -X GET "http://localhost:8501/api/v1/health"
```

### æµ‹è¯•ç¯å¢ƒ
**é€‚ç”¨åœºæ™¯**: é›†æˆæµ‹è¯•ã€æ€§èƒ½æµ‹è¯•ã€é¢„å‘å¸ƒéªŒè¯

**æŠ€æœ¯æ ˆ**:
- ä¸å¼€å‘ç¯å¢ƒç›¸åŒ
- åŒ…å«å®Œæ•´çš„æµ‹è¯•æ•°æ®
- æ”¯æŒè´Ÿè½½æµ‹è¯•

**é…ç½®ç¤ºä¾‹**:
```yaml
# docker-compose.test.yml
version: '3.8'

services:
  tradingagents-api:
    build: .
    environment:
      - TESTING=true
      - MOCK_EXTERNAL_APIS=true
    depends_on:
      - mongodb
      - redis
    volumes:
      - ./tests:/app/tests
      - ./config:/app/config

  mongodb:
    image: mongo:6.0
    volumes:
      - mongodb_data:/data/db
      - mongodb_logs:/logs

  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data
```

### é¢„å‘å¸ƒç¯å¢ƒ
**é€‚ç”¨åœºæ™¯**: ç±»ç”Ÿäº§ç¯å¢ƒã€ç”¨æˆ·éªŒæ”¶æµ‹è¯•

**æŠ€æœ¯æ ˆ**:
- ä¸ç”Ÿäº§ç¯å¢ƒç›¸åŒ
- ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
- å®Œæ•´ç›‘æ§å’Œæ—¥å¿—

**é…ç½®ç¤ºä¾‹**:
```yaml
# docker-compose.staging.yml
version: '3.8'

services:
  tradingagents-api:
    build: .
    environment:
      - ENVIRONMENT=staging
      - MOCK_EXTERNAL_APIS=false
    depends_on:
      - mongodb
      - redis
    volumes:
      - ./logs:/app/logs
      - ./config:/app/config

  mongodb:
    image: mongo:6.0
    volumes:
      - mongodb_staging_data:/data/db
      - mongodb_logs:/logs

  redis:
    image: redis:7-alpine
    volumes:
      - redis_staging_data:/data
```

### ç”Ÿäº§ç¯å¢ƒ
**é€‚ç”¨åœºæ™¯**: ç”Ÿäº§éƒ¨ç½²ã€å¤§è§„æ¨¡ç”¨æˆ·è®¿é—®

**æŠ€æœ¯æ ˆ**:
- å®¹å™¨ç¼–æ’ï¼šDocker + Kubernetes/Orchestration
- è´Ÿè½½å‡è¡¡ï¼šNginx/Traefik
- ç›‘æ§ç³»ç»Ÿï¼šPrometheus + Grafana
- æ—¥å¿—ç³»ç»Ÿï¼šELK Stack

## ğŸ³ å®¹å™¨åŒ–éƒ¨ç½²

### Dockeréƒ¨ç½²

#### 1. åŸºç¡€é…ç½®
```bash
# æ„å»ºé•œåƒ
docker build -t tradingagents-cn .

# è¿è¡Œå®¹å™¨
docker run -d \
  -p 8501:8501 \
  -v $(pwd)/config:/app/config \
  -v $(pwd)/logs:/app/logs \
  tradingagents-cn:latest \
  --env-file .env
```

#### 2. Docker Compose
```yaml
# docker-compose.yml
version: '3.8'

services:
  tradingagents-api:
    build: .
    ports:
      - "8501:8501"
    environment:
      - DASHSCOPE_API_KEY=${DASHSCOPE_API_KEY}
      - FINNHUB_API_KEY=${FINNHUB_API_KEY}
      - MONGODB_URL=${MONGODB_URL}
      - REDIS_URL=${REDIS_URL}
    depends_on:
      - mongodb
      - redis
    volumes:
      - ./logs:/app/logs
      - ./config:/app/config
      - mongodb_data:/data/db
      redis_data:/data

  mongodb:
    image: mongo:6.0
    volumes:
      - mongodb_data:/data/db
      - mongodb_logs:/logs
    environment:
      - MONGO_INITDB_ROOT_USERNAME=admin
      - MONGO_INITDB_ROOT_PASSWORD=admin123
      - MONGO_INITDB_DATABASE=tradingagents

  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
    depends_on:
      - tradingagents-api
```

#### 3. ç¯å¢ƒå˜é‡é…ç½®
```bash
# .env
# ç”Ÿäº§ç¯å¢ƒé…ç½®
ENVIRONMENT=production
DEBUG_MODE=false
LOG_LEVEL=INFO

# æ•°æ®åº“é…ç½®
MONGODB_ENABLED=true
MONGODB_URL=mongodb://admin:admin123@mongodb:27017/tradingagents?authSource=admin
REDIS_ENABLED=true
REDIS_URL=redis://:tradingants123@redis:6379/0

# APIå¯†é’¥
DASHSCOPE_API_KEY=sk-xxxxxxxxx
FINNHUB_API_KEY=xxxxxxxxx
DEEPSEEK_API_KEY=sk-xxxxxxxxx

# å®‰å…¨é…ç½®
SECRET_KEY=your-super-secret-jwt-key
CORS_ORIGINS=http://localhost:8501
ALLOWED_HOSTS=*

# æ€§èƒ½é…ç½®
MAX_WORKERS=4
CACHE_TTL=3600
API_RATE_LIMIT=100
REQUEST_TIMEOUT=60
```

### Kuberneteséƒ¨ç½²

#### 1. åŸºç¡€éƒ¨ç½²
```yaml
# k8s/namespace.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: tradingagents
```

```yaml
# k8s/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: tradingagents-api
  labels:
    app: tradingagents
spec:
  replicas: 3
  selector:
    matchLabels:
      app: tradingagents
  template:
    metadata:
      labels:
        app: tradingagents
    spec:
      containers:
      - name: tradingagents-api
        image: tradingagents-cn:latest
        ports:
          - containerPort: 8501
        env:
          - name: ENVIRONMENT
            value: "production"
          - name: MONGODB_URL
            valueFrom:
              secretKeyRef: mongodb-url
          - name: REDIS_URL
            valueFrom:
              secretKeyRef: redis-url
          - name: DASHSCOPE_API_KEY
            valueFrom:
              secretKeyRef: dashscope-api-key
        resources:
          requests:
            memory: "1Gi"
            cpu: "500m"
        volumeMounts:
          - name: config-volume
            mountPath: /app/config
          - name: logs-volume
            mountPath: /app/logs
```

#### 2. å¯†å­˜å’ŒæŒä¹…åŒ–
```yaml
# k8s/persistent-volume.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: mongodb-pvc
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 10Gi

---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: mongodb-pvc
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 10Gi
```

#### 3. é…ç½®ç®¡ç†
```yaml
# k8s/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: tradingagents-config
data:
  ENVIRONMENT: "production"
  LOG_LEVEL: "INFO"
  MAX_WORKERS: "4"
  API_RATE_LIMIT: "100"
```

#### 4. å¯†é’¥ç®¡ç†
```yaml
# k8s/secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: tradingagents-secrets
type: Opaque
data:
  DASHSCOPE_API_KEY: <base64-encoded-key>
  FINNHUB_API_KEY: <base64-encoded-key>
  MONGODB_URL: mongodb://admin:password@mongodb:27017/tradingagents
  REDIS_URL: redis://:password@redis:6379/0
  SECRET_KEY: <base64-encoded-jwt-key>
```

### 5. æœåŠ¡å’ŒIngress
```yaml
# k8s/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: tradingagents-api-service
spec:
  selector:
    app: tradingagents
  ports:
    - port: 8501
      targetPort: 8501
      nodePort: 30001
  type: LoadBalancer
  type: ClusterIP
  sessionAffinity: ClientIP
```

```yaml
# k8s/ingress.yaml
apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  name: tradingagents-ingress
  annotations:
    kubernetes.io/ingress.class: "nginx"
spec:
  rules:
    - host: api.tradingagents.com
    http:
      paths:
        - path: /
          backend:
            service:
              name: tradingagents-api-service
              port:
                number: 8501
  tls:
                - termination: edge
  tls:
                  - hosts:
                    - api.tradingagents.com
```

### Helm Charts
```bash
# åˆ›å»º Helm Chart
helm create tradingagents-chart \
  --dependency-update tradingagents-cn \
  --version 0.1.0 \
  --app-version 1.0.0

# Chart ç»“æ„
tradingagents-chart/
â”œâ”€â”€ Chart.yaml          # Chart å…ƒæ•°æ®
â”œâ”€â”€ values.yaml           # é»˜è®¤é…ç½®
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ deployment.yaml    # K8s éƒ¨ç½²æ¨¡æ¿
â”‚   â”œâ”€â”€ service.yaml       # K8s æœåŠ¡æ¨¡æ¿
â”‚   â”œâ”€â”€ ingress.yaml        # K8s Ingress æ¨¡æ¿
â”‚   â””â”€â”€ configmap.yaml    # é…ç½®æ˜ å°„æ¨¡æ¿
â””â”€â”€ templates/tests/     # æµ‹è¯•æ¨¡æ¿
```

## â˜ï¸ äº‘å¹³å°éƒ¨ç½²

### é˜¿é‡Œäº‘
```bash
# 1. åˆ›å»ºECSå®ä¾‹
ecs-cli configure region us-west-2 \
  --instance-type t3.medium \
  --image-id ami-123456789 \
  --key-pair TradingAgentsKeyPair \
  --iam-instance-profile arn:aws:iam::123456789:instance-profile/tradingagents \
  --security-group tradingagents-admin \
  --tag Environment=Production

# 2. éƒ¨ç½²æœåŠ¡
ecs-cli up --cluster tradingagents-cluster \
  --service tradingagents-service \
  --task-definition tradingagents-task

# 3. é…ç½®è´Ÿè½½å‡è¡¡å™¨
ecs-cli register-load-balancer \
  --name tradingagents-elb \
  --subnets tradingagents-subnet \
  --security-group tradingagents-security \
  --listener protocol TCP:80 \
  --default-actions target-group-arn:arn:aws:elasticloadbalancing:target-groups/tradingagents
```

### è…¾é‡Œäº‘
```bash
# 1. åˆ›å»ºèµ„æºç»„
az group create \
  --name TradingAgents-RG \
  --location eastus

# 2. åˆ›å»ºåº”ç”¨æœåŠ¡è®¡åˆ’
az appservice plan create \
  --name tradingagents-app \
  --resource-group TradingAgents-RG \
  --sku B1 \
  --instance-count 3

# 3. éƒ¨ç½²åº”ç”¨
az appservice up \
  --resource-group TradingAgents-RG \
  --name tradingagents-app \
  --plan tradingagents-app-plan

# 4. é…ç½®åº”ç”¨ç½‘å…³
az network gateway create \
  --resource-group TradingAgents-RG \
  --name tradingagents-gateway \
  --location eastus \
  --public-ip-address true \
  --sku Standard_v2
```

### è…·é‡Œäº‘ (è…¾è®¯äº‘)
```bash
# 1. ç™»å½•è…¾è®¯äº‘
ccloud login

# 2. åˆ›å»ºé›†ç¾¤
ccloud ccs create cluster-id=tradingagents-cluster \
  --region=ap-chengdu \
  --zone=ap-chengdu-1 \
  --node-type=2RAM.4G \
  --count=3

# 3. éƒ¨ç½²åº”ç”¨
ccloud tccli create service \
  --cluster-id tradingagents-cluster \
  --service-name tradingagents \
  --image tradingagents-cn:latest \
  --replicas=3
  --env-file tcloud.env

# 4. é…ç½®è´Ÿè½½å‡è¡¡
ccloud clb create lb \
  --name tradingagents-lb \
  --type=PUBLIC \
  --region=ap-chengdu \
  --security-group=tradingagents-security \
  --domain=api.tradingagents.com
```

### åä¸ºäº‘
```bash
# 1. ç™»å½•åä¸ºäº‘
hcloud login

# 2. åˆ›å»ºé›†ç¾¤
hcloud cci create cluster \
  --region cn-north-4 \
  --node-type general-purpose \
  --node-count 3 \
  --name tradingagents-cluster

# 3. éƒ¨ç½²æœåŠ¡
hcloud cci create service \
  --cluster tradingagents-cluster \
  --service-name tradingagents-api \
  --image tradingagents-cn:latest \
  --replicas 3
  --env-file hcloud.env
```

## ğŸ”§ ç¯å¢ƒé…ç½®

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# ç”Ÿäº§ç¯å¢ƒ (.env)
ENVIRONMENT=production
DEBUG_MODE=false
LOG_LEVEL=INFO
API_HOST=0.0.0.0
API_PORT=8501
MAX_WORKERS=8
CACHE_TTL=7200

# æ•°æ®åº“é…ç½®
MONGODB_URL=mongodb://user:password@mongodb:27017/tradingagents
MONGODB_DATABASE=tradingagents
REDIS_URL=redis://:password@redis:6379/0
DATABASE_POOL_SIZE=20
CACHE_POOL_MAX_SIZE=50

# å®‰å…¨é…ç½®
SECRET_KEY=your-jwt-secret-key
JWT_ALGORITHM=HS256
JWT_EXPIRATION=86400
CORS_ORIGINS=https://api.tradingagents.com
ALLOWED_HOSTS=api.tradingagents.com

# ç›‘æ§é…ç½®
PROMETHEUS_ENDPOINT=http://prometheus:9090
GRAFANA_ENDPOINT=http://grafana:3000
Sentry_DSN=your-sentry-dsn
```

### Docker Compose é…ç½®

#### å¼€å‘ç¯å¢ƒ (docker-compose.dev.yml)
```yaml
version: '3.8'

services:
  tradingagents-api:
    build:
      context: .
      dockerfile: Dockerfile.dev
    ports:
      - "8501:8501"
    environment:
      - ENVIRONMENT=development
      - DEBUG_MODE=true
      - RELOAD=true
    volumes:
      - .:/app
      - ./logs:/app/logs
      - ./config:/app/config
    depends_on:
      - mongodb
      - redis

  mongodb:
    image: mongo:6.0
    ports:
      - "27017:27017"
    volumes:
      - mongodb_data:/data/db
      - mongodb_logs:/logs

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data

  dev-tools:
    image: tradingagents-cn:latest
    command: pytest
    volumes:
      - .:/app
    environment:
      - TESTING=true
```

#### ç”Ÿäº§ç¯å¢ƒ (docker-compose.prod.yml)
```yaml
version: '3.8'

services:
  tradingagents-api:
    image: tradingagents-cn:latest
    restart: unless-stopped
    ports:
      - "8501:8501"
    environment:
      - ENVIRONMENT=production
      - DEBUG_MODE=false
      - RELOAD=false
    deploy:
      replicas: 3
      resources:
        limits:
          cpus: '1000m'
          memory: '2Gi'
    volumes:
      - ./logs:/app/logs
      - ./config:/app/config
      - mongodb_data:/data/db
    depends_on:
      - mongodb
      - redis
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8501/api/v1/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
    depends_on:
      - tradingagents-api
    restart: unless-stopped
```

#### é«˜å¯ç”¨ç¯å¢ƒ (docker-compose.ha.yml)
```yaml
version: '3.8'

services:
  tradingagents-api-1:
    image: tradingagents-cn:latest
    environment:
      - ENVIRONMENT=production
      - REDIS_URL=redis://redis-1:6379/1
    deploy:
      replicas: 2
    depends_on:
      - redis-1

  tradingagents-api-2:
    image: tradingagents-cn:latest
    environment:
      - ENVIRONMENT=production
      - REDIS_URL=redis://redis-2:6379/1
    deploy:
      replicas: 2
    depends_on:
      - redis-2

  redis-1:
    image: redis:7-alpine
    command: redis-server --appendonly yes
    volumes:
      - redis-1_data:/data

  redis-2:
    image: redis:7-alpine
    command: redis-server --appendonly yes
    volumes:
      - redis-2_data:/data

  nginx-ha:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx/nginx-ha.conf:/etc/nginx/nginx.conf:ro
    depends_on:
      - tradingagents-api-1
      - tradingagents-api-2
```

## ğŸš¦ ç›‘æ§å’Œæ—¥å¿—

### åº”ç”¨ç›‘æ§
```yaml
# prometheus.yml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'tradingagents'
    static_configs:
      - targets: ['localhost:8501/api/v1/metrics']
    metrics_path: '/api/v1/metrics'
    params:
      format: 'prometheus'
```

### æ—¥å¿—èšåˆ
```yaml
# filebeat.yml
filebeat.inputs:
  - type: log
  paths:
    - /app/logs/*.log

output.elasticsearch:
  hosts: ["elasticsearch:9200"]
  index: "tradingagents-logs"

logging:
  level: info
  codecs: plain
  filebeat:
    name: tradingagents-logs
    keep_fields: ["timestamp", "level", "message"]
```

## ğŸ”’ å®‰å…¨é…ç½®

### SSL/TLSé…ç½®

### è¯ä¹¦ç®¡ç†
```bash
# ç”Ÿæˆè‡ªç­¾åè¯ä¹¦
openssl req -x509 -newkey rsa:2048 \
  -newkey ec:256 \
  -nodes \
  -days 365 \
  -out tradingagents-cert.pem \
  -keyout tradingagents-key.pem \
  -subj "/C=CN/O=TradingAgents" \
  -reqext SAN=api.tradingagents.com

# é…ç½®Nginx SSL
server {
    listen 443 ssl http2;
    ssl_certificate /etc/ssl/tradingagents-cert.pem;
    ssl_certificate_key /etc/ssl/tradingagents-key.pem;
    ssl_session_timeout 1d;

    location / {
        /api/ {
            proxy_pass http://localhost:8501;
            proxy_set_header Host $http_host;
            proxy_set_header X-Forwarded-Proto $scheme;
        }
    }
}
```

### ç½‘ç»œå®‰å…¨
```yaml
# docker-compose.security.yml
version: '3.8'

services:
  nginx:
    image: nginx:alpine
    ports:
      - "80:443"
    volumes:
      - ./nginx/security.conf:/etc/nginx/conf.d:ro
      - ./ssl:/etc/ssl:/ro
    depends_on:
      - tradingagents-api

  tradingagents-api:
    build: .
    networks:
      - tradingagents-internal
    environment:
      - ENABLE_NETWORK_MODE=true
    deploy:
      replicas: 3
```
```

networks:
  tradingagents-internal:
    driver: bridge
    internal: true
    ipam:
      config:
        - subnet: 172.20.0.0/16
        ip_range: 172.20.0.2-172.20.0.254
```

### è®¿é—®æ§åˆ¶
```yaml
# docker-compose.access-control.yaml
version: '3.8'

services:
  nginx:
    image: nginx:alpine
    volumes:
      - ./nginx/access-control.conf:/etc/nginx/conf.d:ro
    depends_on:
      - tradingagents-api

  redis:
    image: redis:7-alpine
    volumes:
      - ./redis/access-control:/data
      - ./redis/access-control.conf
    command: redis-server --appendonly yes --requirepass your-redis-password

  tradingagents-api:
    build: .
    networks:
      - tradingagents-internal
    environment:
      - ENABLE_ACCESS_CONTROL=true
      - ACCESS_TOKEN_HEADER=X-Access-Token
      - ENABLE_RATE_LIMITING=true
    depends_on:
      - redis
      - nginx
```

## ğŸ“Š å¤‡ä»½å’Œæ¢å¤

### æ•°æ®å¤‡ä»½ç­–ç•¥
```bash
# MongoDBå¤‡ä»½
mongodump --uri mongodb://user:password@localhost:27017/tradingagents \
  --out /backup/mongodb/backup-$(date +%Y%m%d).tar.gz

# å¢é‡å¤‡ä»½
rsync -av /data/db/ /backup/incremental/$(date +%Y%m%d)/

# åº”ç”¨å¤‡ä»½
tar -czf /app/ backup/application-$(date +%Y%m%d).tar.gz \
  --exclude=node_modules \
  --exclude=.env \
  /app/ backup/

# é…ç½®æ–‡ä»¶å¤‡ä»½
tar -czf config/ backup/config-$(date +%Y%m%d).tar.gz \
  /docker-compose.yml
```

### æ¢å¤ç­–ç•¥
```bash
# æ¢å¤æ•°æ®åº“
mongorestore --uri mongodb://user:password@localhost:27017/tradingagents \
  --db tradingagents \
  --drop \
  --restore /backup/mongodb/backup-2024-01-15.tar.gz

# æ¢å¤åº”ç”¨
tar -xzf /backup/application-2024-01-15.tar.gz

# éªŒè¯æ¢å¤
curl -X GET "http://localhost:8501/api/v1/health"
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### åº”ç”¨æ€§èƒ½ä¼˜åŒ–
```yaml
# docker-compose.performance.yml
version: '3.8'

services:
  tradingagents-api:
    image: tradingagents-cn:latest
    environment:
      - PYTHONUNBUFFERED=1
      - WORKERS=4
      - MAX_REQUESTS=1000
      - REQUEST_TIMEOUT=60
    deploy:
      replicas: 4
      resources:
        limits:
          cpus: '2000m'
          memory: '4Gi'
        reservations:
          cpus: '1000m'
          memory: '2Gi'
    volumes:
      - ./logs:/app/logs
    depends_on:
      - mongodb
      - redis
```

### æ•°æ®åº“ä¼˜åŒ–
```javascript
// MongoDBç´¢å¼•ä¼˜åŒ–
db.analysis.createIndex({ "symbol": 1, "analysis_date": -1 }, { name: "idx_symbol_date", unique: true })
db.analysis.createIndex({ "symbol": 1, "created_at": -1 }, { name: "idx_created_at" })
db.analysis.createIndex({ "provider": 1, "model": 1 }, { name: "idx_provider_model" })

// Redisé…ç½®ä¼˜åŒ–
maxmemory-policy allkeys-lru
maxmemory-samples 25
save 900 1 10 300
```

### ç¼“å­˜ä¼˜åŒ–
```python
# æ™ºèƒ½ç¼“å­˜é…ç½®
CACHE_CONFIG = {
    'max_memory_size': 100 * 1024 * 1024,  # 100MB
    'strategy': 'adaptive',
    'ttl_patterns': {
        'stock_data': 3600,  # 1å°æ—¶
        'analysis_results': 1800, # 30åˆ†é’Ÿ
        'user_sessions': 7200,  # 2å°æ—¶
    }
}

# ç¼“å­˜é¢„çƒ­
def warm_up_cache():
    # é¢„åŠ è½½çƒ­ç‚¹æ•°æ®
    pass
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æ•°æ®åº“è¿æ¥é—®é¢˜
```bash
# æ£€æŸ¥MongoDBè¿æ¥
docker exec -it tradingagents-mongodb mongo \
  --eval "db.adminCommand('ismaster')"

# æ£€æŸ¥Redisè¿æ¥
docker exec -it tradingagents-redis redis-cli \
  PING

# æ£€æŸ¥ç½‘ç»œè¿æ¥
docker exec -it tradingagents-api \
  curl -X GET "http://localhost:8501/api/v1/health"
```

#### 2. å†…å­˜é—®é¢˜
```bash
# æ£€æŸ¥å®¹å™¨å†…å­˜ä½¿ç”¨
docker stats tradingagents-api

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# æ¸…ç†æœªä½¿ç”¨çš„å®¹å™¨
docker system prune -f
```

#### 3. æ€§èƒ½é—®é¢˜
```bash
# æ£€æŸ¥CPUä½¿ç”¨ç‡
docker exec -it tradingagents-api top
top -c

# æ£€æŸ¥å“åº”æ—¶é—´
time curl -o /dev/null -s -w "%{http_code}\n" \
     -X GET "http://localhost:8501/api/v1/metrics" \
     -w "%{time_total}\n"

# åˆ†ææ…¢æŸ¥è¯¢
docker exec -it tradingagents-api \
  python -m cProfile -o profiling.stats \
     -c "from tradingagents.api.main import app; app()"
```

#### 4. åº”ç”¨å´©æºƒé—®é¢˜
```bash
# æ£€æŸ¥åº”ç”¨æ—¥å¿—
docker logs tradingagents-api --tail 100

# æ£€æŸ¥ç³»ç»Ÿèµ„æº
docker exec -it tradingagents-api \
  free -h && df -h

# é‡å¯åº”ç”¨æœåŠ¡
docker-compose restart tradingagents-api

# æ£€æŸ¥ä¾èµ–æœåŠ¡
docker-compose ps
```

#### 5. SSLè¯ä¹¦é—®é¢˜
```bash
# æ£€æŸ¥è¯ä¹¦æœ‰æ•ˆæœŸ
openssl x509 -in /etc/ssl/certs/api.crt -noout -dates

# éªŒè¯è¯ä¹¦é“¾
openssl verify -CAfile /etc/ssl/certs/ca.crt \
  /etc/ssl/certs/api.crt

# æµ‹è¯•HTTPSè¿æ¥
curl -v https://api.tradingagents-cn.com/api/v1/health
```

#### 6. æƒé™å’Œå®‰å…¨é—®é¢˜
```bash
# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la /app/keys/ /app/logs/

# ä¿®å¤æƒé™é—®é¢˜
docker exec -it tradingagents-api \
  chown -R app:app /app/keys/ /app/logs/

# æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
ufw status
iptables -L
```

## ğŸš¨ ç´§æ€¥å“åº”æµç¨‹

### ç”Ÿäº§ç¯å¢ƒæ•…éšœå“åº”
```bash
#!/bin/bash
# scripts/emergency_response.sh

set -e

SEVERITY=${1:-medium}
COMPONENT=${2:-all}

echo "ğŸš¨ ç´§æ€¥å“åº”æµç¨‹å¯åŠ¨ - ä¸¥é‡çº§åˆ«: $SEVERITY"

# 1. å¿«é€Ÿè¯„ä¼°
echo "ğŸ“Š ç³»ç»ŸçŠ¶æ€è¯„ä¼°..."
docker-compose ps
curl -s http://localhost:8501/api/v1/health || echo "APIæœåŠ¡å¼‚å¸¸"

# 2. ç«‹å³ä¿æŠ¤æªæ–½
if [ "$SEVERITY" = "critical" ]; then
    echo "ğŸ›¡ï¸ æ‰§è¡Œå…³é”®ä¿æŠ¤æªæ–½..."

    # åˆ‡æ¢åˆ°åªè¯»æ¨¡å¼
    curl -X POST "http://localhost:8501/api/v1/admin/maintenance" \
         -H "Authorization: Bearer $ADMIN_TOKEN" \
         -d '{"mode": "readonly"}'

    # ä¿å­˜å½“å‰çŠ¶æ€
    docker-compose logs > emergency-logs-$(date +%Y%m%d-%H%M%S).log

    # é€šçŸ¥å›¢é˜Ÿ
    curl -X POST "https://hooks.slack.com/services/$SLACK_WEBHOOK" \
         -d '{"text": "ğŸš¨ TradingAgents-CN ç´§æ€¥ç»´æŠ¤æ¨¡å¼å·²å¯åŠ¨"}'
fi

# 3. ç»„ä»¶ç‰¹å®šå“åº”
case $COMPONENT in
    "api")
        echo "ğŸ”§ APIç»„ä»¶æ•…éšœå“åº”..."
        docker-compose restart tradingagents-api
        ;;
    "database")
        echo "ğŸ’¾ æ•°æ®åº“ç»„ä»¶æ•…éšœå“åº”..."
        docker-compose restart mongodb
        docker exec tradingagents_mongodb mongod --repair
        ;;
    "cache")
        echo "âš¡ ç¼“å­˜ç»„ä»¶æ•…éšœå“åº”..."
        docker-compose restart redis
        docker exec tradingagents_redis redis-cli FLUSHALL
        ;;
    "all")
        echo "ğŸ”„ å…¨ç³»ç»Ÿé‡å¯..."
        docker-compose restart
        ;;
esac

# 4. éªŒè¯æ¢å¤
echo "ğŸ” éªŒè¯ç³»ç»Ÿæ¢å¤..."
sleep 30

for i in {1..5}; do
    HEALTH_STATUS=$(curl -s -o /dev/null -w "%{http_code}" http://localhost:8501/api/v1/health)
    if [ "$HEALTH_STATUS" = "200" ]; then
        echo "âœ… ç³»ç»Ÿæ¢å¤æˆåŠŸ"
        break
    else
        echo "â³ ç­‰å¾…ç³»ç»Ÿæ¢å¤... ($i/5)"
        sleep 30
    fi
done

# 5. å‘é€çŠ¶æ€é€šçŸ¥
if [ "$HEALTH_STATUS" = "200" ]; then
    curl -X POST "https://hooks.slack.com/services/$SLACK_WEBHOOK" \
         -d '{"text": "âœ… TradingAgents-CN ç³»ç»Ÿå·²æ¢å¤æ­£å¸¸"}'
else
    curl -X POST "https://hooks.slack.com/services/$SLACK_WEBHOOK" \
         -d '{"text": "âŒ TradingAgents-CN ç³»ç»Ÿæ¢å¤å¤±è´¥ï¼Œéœ€è¦äººå·¥ä»‹å…¥"}'
fi

echo "ğŸ“‹ ç´§æ€¥å“åº”æµç¨‹å®Œæˆ"
```

### æ•°æ®æ¢å¤æµç¨‹
```bash
#!/bin/bash
# scripts/data_recovery.sh

BACKUP_DATE=${1:-$(date +%Y%m%d)}
RECOVERY_TYPE=${2:-full}

echo "ğŸ”„ å¼€å§‹æ•°æ®æ¢å¤ - å¤‡ä»½æ—¥æœŸ: $BACKUP_DATE"

# 1. åœæ­¢ç›¸å…³æœåŠ¡
echo "â¸ï¸ åœæ­¢æœåŠ¡..."
docker-compose stop tradingagents-api

# 2. æ•°æ®åº“æ¢å¤
if [ "$RECOVERY_TYPE" = "full" ] || [ "$RECOVERY_TYPE" = "database" ]; then
    echo "ğŸ’¾ æ¢å¤æ•°æ®åº“..."
    docker-compose stop mongodb

    # å¤‡ä»½å½“å‰æ•°æ®
    mv /var/lib/mongodb /var/lib/mongodb.backup.$(date +%Y%m%d-%H%M%S)

    # æ¢å¤å¤‡ä»½
    tar -xzf /backup/mongodb/backup-$BACKUP_DATE.tar.gz -C /

    docker-compose start mongodb
    sleep 30
fi

# 3. ç¼“å­˜æ¢å¤
if [ "$RECOVERY_TYPE" = "full" ] || [ "$RECOVERY_TYPE" = "cache" ]; then
    echo "âš¡ æ¢å¤ç¼“å­˜..."
    docker-compose restart redis
fi

# 4. åº”ç”¨é…ç½®æ¢å¤
if [ "$RECOVERY_TYPE" = "full" ]; then
    echo "âš™ï¸ æ¢å¤åº”ç”¨é…ç½®..."
    tar -xzf /backup/application/backup-$BACKUP_DATE.tar.gz -C /app/
fi

# 5. éªŒè¯æ¢å¤
echo "ğŸ” éªŒè¯æ•°æ®æ¢å¤..."
docker-compose start tradingagents-api
sleep 60

# æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
docker exec tradingagents-api python -c "
from tradingagents.database import DatabaseManager
db = DatabaseManager()
result = db.verify_data_integrity()
print(f'æ•°æ®å®Œæ•´æ€§æ£€æŸ¥: {\"é€šè¿‡\" if result else \"å¤±è´¥\"}')
"

# APIåŠŸèƒ½æµ‹è¯•
curl -X POST "http://localhost:8501/api/v1/auth/login" \
     -H "Content-Type: application/json" \
     -d '{"username": "test", "password": "test"}' \
     && echo "âœ… APIåŠŸèƒ½æ­£å¸¸" || echo "âŒ APIåŠŸèƒ½å¼‚å¸¸"

echo "ğŸ“‹ æ•°æ®æ¢å¤æµç¨‹å®Œæˆ"
```

## ğŸ“Š å®¹é‡è§„åˆ’

### ç¡¬ä»¶èµ„æºè§„åˆ’

#### å°å‹éƒ¨ç½²ï¼ˆ100-500ç”¨æˆ·ï¼‰
```yaml
# docker-compose.small.yml
version: '3.8'

services:
  tradingagents-api:
    deploy:
      replicas: 2
      resources:
        limits:
          cpus: '1000m'
          memory: '2Gi'
        reservations:
          cpus: '500m'
          memory: '1Gi'

  mongodb:
    deploy:
      resources:
        limits:
          cpus: '500m'
          memory: '2Gi'
        reservations:
          cpus: '250m'
          memory: '1Gi'

  redis:
    deploy:
      resources:
        limits:
          cpus: '250m'
          memory: '1Gi'
        reservations:
          cpus: '100m'
          memory: '512Mi'

# æ¨èé…ç½®
# CPU: 4æ ¸å¿ƒ
# å†…å­˜: 8GB
# å­˜å‚¨: 100GB SSD
# ç½‘ç»œ: 100Mbps
```

#### ä¸­å‹éƒ¨ç½²ï¼ˆ500-2000ç”¨æˆ·ï¼‰
```yaml
# docker-compose.medium.yml
version: '3.8'

services:
  tradingagents-api:
    deploy:
      replicas: 4
      resources:
        limits:
          cpus: '1500m'
          memory: '3Gi'
        reservations:
          cpus: '750m'
          memory: '1.5Gi'

  mongodb:
    deploy:
      resources:
        limits:
          cpus: '1000m'
          memory: '4Gi'
        reservations:
          cpus: '500m'
          memory: '2Gi'

  redis:
    deploy:
      resources:
        limits:
          cpus: '500m'
          memory: '2Gi'
        reservations:
          cpus: '250m'
          memory: '1Gi'

# æ¨èé…ç½®
# CPU: 8æ ¸å¿ƒ
# å†…å­˜: 16GB
# å­˜å‚¨: 500GB SSD
# ç½‘ç»œ: 1Gbps
```

#### å¤§å‹éƒ¨ç½²ï¼ˆ2000+ç”¨æˆ·ï¼‰
```yaml
# docker-compose.large.yml
version: '3.8'

services:
  tradingagents-api:
    deploy:
      replicas: 8
      resources:
        limits:
          cpus: '2000m'
          memory: '4Gi'
        reservations:
          cpus: '1000m'
          memory: '2Gi'

  mongodb:
    image: mongo:6.0
    command: mongod --replSet rs0 --shardsvr
    deploy:
      replicas: 3
      resources:
        limits:
          cpus: '2000m'
          memory: '8Gi'
        reservations:
          cpus: '1000m'
          memory: '4Gi'

  redis:
    image: redis:7-alpine
    command: redis-server --cluster-enabled yes
    deploy:
      replicas: 6
      resources:
        limits:
          cpus: '1000m'
          memory: '4Gi'
        reservations:
          cpus: '500m'
          memory: '2Gi'

# æ¨èé…ç½®
# CPU: 16æ ¸å¿ƒ
# å†…å­˜: 32GB
# å­˜å‚¨: 2TB SSD
# ç½‘ç»œ: 10Gbps
```

### æ‰©å±•ç­–ç•¥

#### æ°´å¹³æ‰©å±•
```bash
#!/bin/bash
# scripts/scale_horizontal.sh

INSTANCE_COUNT=${1:-2}

echo "ğŸ“ˆ æ°´å¹³æ‰©å±•åˆ° $INSTANCE_COUNT ä¸ªå®ä¾‹"

# 1. æ›´æ–°Docker Composeé…ç½®
sed -i "s/replicas: [0-9]*/replicas: $INSTANCE_COUNT/" docker-compose.yml

# 2. é‡æ–°éƒ¨ç½²
docker-compose up -d --scale tradingagents-api=$INSTANCE_COUNT

# 3. æ›´æ–°è´Ÿè½½å‡è¡¡å™¨
docker-compose restart nginx

# 4. éªŒè¯æ‰©å±•
curl -X GET "http://localhost/api/v1/metrics" \
     && echo "âœ… æ°´å¹³æ‰©å±•æˆåŠŸ"
```

#### å‚ç›´æ‰©å±•
```bash
#!/bin/bash
# scripts/scale_vertical.sh

CPU_LIMITS=${1:-2000m}
MEMORY_LIMITS=${2:-4Gi}

echo "â¬†ï¸ å‚ç›´æ‰©å±•åˆ° CPU:$CPU_LIMITS, å†…å­˜:$MEMORY_LIMITS"

# 1. æ›´æ–°èµ„æºé™åˆ¶
sed -i "s/cpus: '[0-9]*m'/cpus: '$CPU_LIMITS'/" docker-compose.yml
sed -i "s/memory: '[0-9]*Gi'/memory: '$MEMORY_LIMITS'/" docker-compose.yml

# 2. é‡æ–°éƒ¨ç½²
docker-compose up -d

# 3. éªŒè¯æ‰©å±•
docker stats tradingagents-api --no-stream
```

## ğŸ”— ç›¸å…³é“¾æ¥

- **é¡¹ç›®ä¸»é¡µ**: [TradingAgents-CN GitHub](https://github.com/hsliuping/TradingAgents-CN)
- **APIæ–‡æ¡£**: [APIå‚è€ƒæ–‡æ¡£](../api/README.md)
- **å¼€å‘æŒ‡å—**: [å¼€å‘æŒ‡å—](DEVELOPMENT.md)
- **è´¡çŒ®æŒ‡å—**: [è´¡çŒ®æŒ‡å—](../CONTRIBUTING.md)
- **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/hsliuping/TradingAgents-CN/issues)

---

**æ›´æ–°æ—¥æœŸ**: 2025-01-25
**ç‰ˆæœ¬**: v1.0.0
**ç»´æŠ¤è€…**: TradingAgents-CN å¼€å‘å›¢é˜Ÿ

---

*æœ¬éƒ¨ç½²æ–‡æ¡£æ¶µç›–äº†ä»å¼€å‘ç¯å¢ƒåˆ°ç”Ÿäº§ç¯å¢ƒçš„å®Œæ•´éƒ¨ç½²æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æ€§èƒ½ä¼˜åŒ–ã€ç›‘æ§å‘Šè­¦ã€æ•…éšœæ’é™¤å’Œç´§æ€¥å“åº”æµç¨‹ã€‚å¦‚æœ‰é—®é¢˜è¯·æäº¤Issueæˆ–PRè¿›è¡Œä¿®æ­£ã€‚*
# æ£€æŸ¥åº”ç”¨æ—¥å¿—
docker logs tradingagents-api --tail 100

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker ps -a tradingagents-api

# é‡å¯åº”ç”¨
docker restart tradingagents-api

# è¿›å…¥å®¹å™¨è°ƒè¯•
docker exec -it tradingagents-api bash
```

## ğŸ“Š å‡çº§å’Œå›æ»š

### ç‰ˆæœ¬ç®¡ç†
```bash
# æ ‡è®°ç‰ˆæœ¬
git tag -a v1.0.0 -m "Release v1.0.0"

# å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬
git checkout v0.9.9

# æŸ¥çœ‹ç‰ˆæœ¬å·®å¼‚
git log --oneline --graph --decorate

# åˆ›å»ºå›æ»šè„šæœ¬
#!/bin/bash
git checkout main
git reset --hard v1.0.0
git push -f origin main --force
```

### ç°åº¦éƒ¨ç½²
```bash
# è“åº¦éƒ¨ç½²è„šæœ¬
#!/bin/bash

# 1. å¤‡ä»½å½“å‰ç‰ˆæœ¬
git tag -a backup-v1.0.0

# 2. éƒ¨ç½²æ–°ç‰ˆæœ¬
docker-compose -f docker-compose.prod.yml pull
docker-compose -f docker-compose.prod.yml up -d

# 3. éªŒè¯éƒ¨ç½²
sleep 30
curl -f "http://your-domain.com/api/v1/health"

# 4. å›æ»šç­–ç•¥
# å¦‚æœéƒ¨ç½²å¤±è´¥ï¼Œè‡ªåŠ¨å›æ»š
if [ $? -ne 0 ]; then
    echo "éƒ¨ç½²å¤±è´¥ï¼Œå¼€å§‹å›æ»š..."
    docker-compose -f docker-compose.prod.yml down
    docker load backup-v1.0.0
    docker-compose -f docker-compose.prod.yml up -d
fi
```

## ğŸ”„ CI/CD é›†æˆ

### GitHub Actions é…ç½®
```yaml
# .github/workflows/deploy.yml
name: Deploy to Production

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    environment: production
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup environment
        run: |
          echo "Setting up production environment..."
          # ç¯å¢ƒè®¾ç½®æ­¥éª¤

      - name: Deploy to production
        run: |
          echo "Deploying to production..."
          docker-compose -f docker-compose.prod.yml up -d
          sleep 60

      - name: Health check
        run: |
          echo "Checking deployment health..."
          timeout 300 bash -c "
            until curl -f http://your-domain.com/api/v1/health; do
              sleep 10
              curl -f http://your-domain.com/api/v1/health; exit 0; do
              break
            done"

      - name: Rollback on failure
        if: failure()
        run: |
          echo "Deployment failed, rolling back..."
          docker-compose -f docker-compose.prod.yml down
          # å›æ»šé€»è¾‘
```

### å¤šç¯å¢ƒç®¡ç†
```yaml
# .github/workflows/environments.yml
name: Environment Management

on:
  workflow_call:
    workflows: [deploy-staging, deploy-production]

jobs:
  deploy-staging:
    uses: ./.github/workflows/deploy.yml
    with:
      environment: staging
    strategy:
      matrix:
        environment: [staging-eu, staging-us, staging-asia]

  deploy-production:
    uses: ./.github/workflows/deploy.yml
    with:
      environment: [production-eu, production-us, production-asia]
```

## ğŸ“‹ ç›‘æ§å’Œå‘Šè­¦

### å‘Šè­¦è§„åˆ™
```yaml
# .github/workflows/monitoring.yml
name: Application Monitoring

on:
  schedule:
    - cron: '*/5 * * *'  # æ¯5åˆ†é’Ÿ

jobs:
  health-check:
    runs-on: ubuntu-latest
    steps:
      - name: Check all services
        run: |
          curl -f http://api.tradingagents.com/api/v1/health

  performance-check:
    runs-on: ubuntu-latest
    steps:
      - name: Check response time
        run: |
          curl -o /dev/null -s "%{http_code}\n" \
               -X GET "http://api.tradingagents.com/api/v1/health" \
               -w "%{time_total}\n" \
               || exit 1

  error-check:
    runs-on: ubuntu-latest
    steps:
      - name: Check error logs
        run: |
          docker logs tradingagents-api --since=5m --tail 50
```

### é€šçŸ¥æ¸ é“
```yaml
# .github/workflows/notifications.yml
name: Notifications

on:
  issues:
    types: [opened, closed]
  labels: [bug, critical]

jobs:
  slack-notification:
    runs-on: ubuntu-latest
    if: contains(github.event.issue.labels.*['critical'])
    steps:
      - name: Send Slack notification
        run: |
          curl -X POST -H 'Content-Type: application/json' \
               -d '{"text": "Critical issue: ${{ github.event.issue.title }}", "channel": "#alerts"}' \
               ${{ secrets.SLACK_WEBHOOK }}
```

  email-notification:
    runs-on: ubuntu-latest
    steps:
      - name: Send email notification
        run: |
          curl -X POST -H 'Content-Type: application/json' \
               -d '{"to": "team@company.com", "subject": "Issue: ${{ github.event.issue.title }}", "body": "URL: ${{ github.event.html_url }}"}' \
               ${{ secrets.EMAIL_SMTP }}
```
```

## ğŸ”§ æ‰©å±•å’Œæ’ä»¶

### æ·»åŠ æ–°æ•°æ®æº
1. **åˆ›å»ºæ•°æ®æºé€‚é…å™¨**
   ```python
   # tradingagents/dataflows/new_provider.py
   class NewProviderAdapter(BaseAdapter):
       def fetch_stock_data(self, symbol):
           # å®ç°æ•°æ®è·å–é€»è¾‘
           pass
   ```

2. **æ³¨å†Œé€‚é…å™¨**
   ```python
   from tradingagents.dataflows.interface import register_provider
   register_provider('new_provider', NewProviderAdapter)
   ```

3. **æ›´æ–°é…ç½®**
   ```json
   {
     "providers": {
       "new_provider": {
         "name": "æ–°æ•°æ®æº",
         "description": "æ–°æ•°æ®æºæè¿°",
         "enabled": true
       }
     }
   }
   ```

### æ·»åŠ æ–°LLMæä¾›å•†
1. **åˆ›å»ºLLMé€‚é…å™¨**
   ```python
   # tradingagents.llm_adapters/new_provider.py
   class NewProviderAdapter(BaseLLMAdapter):
       def __init__(self, model, api_key, base_url=None):
           super().__init__()
   ```

2. **æ›´æ–°æ¨¡å‹é…ç½®**
   ```json
   {
     "models": {
       "new_provider": {
         "models": ["model-v1", "model-v2"],
         "default": "model-v1"
       }
     }
   }
   ```

### æ·»åŠ æ–°æ™ºèƒ½ä½“
1. **åˆ›å»ºæ™ºèƒ½ä½“**
   ```python
   # tradingagents/agents/specialists/new_analyst.py
   class NewAnalyst(BaseAnalyst):
       def analyze(self, state):
           # å®ç°åˆ†æé€»è¾‘
           pass
   ```

2. **æ³¨å†Œæ™ºèƒ½ä½“**
   ```python
   from tradingagents.graph.setup import register_analyst
   register_analyst('new_analyst', NewAnalyst)
   ```

## ğŸ¯ æ€§èƒ½ç›‘æ§

### å…³é”®æŒ‡æ ‡
- **å“åº”æ—¶é—´**: APIç«¯ç‚¹çš„å¹³å‡å“åº”æ—¶é—´
- **ååé‡**: æ¯ç§’å¤„ç†çš„è¯·æ±‚æ•°é‡
- **é”™è¯¯ç‡**: å¤±è´¥è¯·æ±‚çš„ç™¾åˆ†æ¯”
- **å†…å­˜ä½¿ç”¨**: å®¹å™¨å†…å­˜å ç”¨
- **CPUä½¿ç”¨**: å®¹å™¨CPUä½¿ç”¨ç‡
- **ç¼“å­˜å‘½ä¸­ç‡**: ç¼“å­˜ç³»ç»Ÿå‘½ä¸­ç‡

### ç›‘æ§å·¥å…·
```yaml
# prometheus.yml
scrape_configs:
  - job_name: 'tradingagents-api'
    metrics_path: '/api/v1/metrics'
    scrape_interval: 15s
    metrics_path: '/api/v1/metrics'

  - job_name: 'tradingagents-db'
    metrics_path: '/api/v1/db/metrics'
    scrape_interval: 30s
    static_configs:
      - targets: ['localhost:27017']
```

### å‘Šè­¦è§„åˆ™
```yaml
# prometheus/rules.yml
groups:
  - name: tradingagents-alerts
    rules:
    - alert: CriticalError
      expr: job:tradingagents-api:job_errors:errors:rate(5m) > 0
      for: 1m
      annotations:
        summary: "High error rate detected"
        description: "TradingAgents API error rate > 5/m"

  - name: tradingagents-availability
    rules:
      - alert: ServiceDown
      expr: up == 0
      for: 5m
      annotations:
        summary: "Service appears down"
        description: "TradingAgents service is down"
```

---

*æœ€åæ›´æ–°ï¼š2025-01-25*
*æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0.0*
*è´£ä»»ç»´æŠ¤ï¼šTradingAgents-CN å¼€å‘å›¢é˜Ÿ*